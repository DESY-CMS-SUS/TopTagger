<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>TopTagger: Top Tagger</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TopTagger
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Top Tagger </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Top Tagging Algorithm</h1>
<p>Add description of algorithm and general options here</p>
<h1>Installation Instructions</h1>
<h2>Installing the tagger in CMS software release</h2>
<h3>Standalone (edm free) install instructions within CMSSW</h3>
<p>These instructions explain how to install the top tagger in a standalone way (i.e. no cmsRun or FWLite required) but taking advantage of all the tools which come packaged with a CMSSW release. If you would rather not go through the hassle of installing ROOT/python/tensorflow, the CMSSW environment can be used to provide the necessary libraries and python modules (9_3_X or later)</p>
<div class="fragment"><div class="line">cmsrel CMSSW_9_4_11</div>
<div class="line">cd CMSSW_9_4_11/src</div>
<div class="line">cmsenv</div>
<div class="line">git clone git@github.com:susy2015/<a class="code" href="classTopTagger.html">TopTagger</a>.git</div>
<div class="line">cd <a class="code" href="classTopTagger.html">TopTagger</a>/<a class="code" href="classTopTagger.html">TopTagger</a>/test</div>
<div class="line">./configure</div>
<div class="line">make -j8 </div>
</div><!-- fragment --><p>The test code can then be run identically to the completely standalone instructions found <a href="../README.md#running-the-example">here</a></p>
<h3>Install tagger integrated in the edm framework</h3>
<p>These instructions explain how to install the top tagger code if you want to run the tagger during nanoAOD production or other cmsRun driven analysis tasks.</p>
<h4>Description of top tagger nanoAOD format</h4>
<p>The tagger will save an abbreviated <a class="el" href="classTopObject.html">TopObject</a> for each top into the nanoAOD. The information stored includes</p>
<div class="fragment"><div class="line">nResolvedTop (<span class="keywordtype">int</span>): The number of resolved tops in the event</div>
<div class="line">ResolvedTop_discriminator (float): The neural network discrimimnator for topness (1 is most top like, 0 is least top like)</div>
<div class="line">ResolvedTop_pt (float): Pt of the top</div>
<div class="line">ResolvedTop_eta (float): Eta of the top</div>
<div class="line">ResolvedTop_phi (float): Phi of the top</div>
<div class="line">ResolvedTop_mass (float): Mass of the top</div>
<div class="line">ResolvedTop_j1Idx (int): Index of the first constituent jet in the main nanoAOD jet collection</div>
<div class="line">ResolvedTop_j2Idx (int): Index of the second constituent jet in the main nanoAOD jet collectino</div>
<div class="line">ResolvedTop_j3Idx (int): Index of the third constituent jet in the main nanoAOD jet collection</div>
<div class="line">ResolvedTop_type (int): The type of top (3 for resolved tops)</div>
</div><!-- fragment --><p>In order to save space in the nanoAOD only top objects passing a basic discriminator cut are saved. Note that if you elect to save all candidates instead of final tops, then the collection will be named "ResolvedTopCandidate" instead of "ResolovedTop."</p>
<h4>Instructions for saving tagger results to nanoAOD with CMSSW_10_2_15</h4>
<p>If starting from a fresh release of CMSSW run the following setup commands</p>
<div class="fragment"><div class="line"><span class="preprocessor">#get CMSSW release</span></div>
<div class="line"><span class="preprocessor"></span>cmsrel CMSSW_10_2_15</div>
<div class="line">cd CMSSW_10_2_15/src/</div>
<div class="line">cmsenv</div>
<div class="line">git cms-init</div>
</div><!-- fragment --><p>The following additional packages should then be checked out to get the top tagging code and the qgAxis1 variable necessary for the latest versions of the tagger.</p>
<div class="fragment"><div class="line">cd ${CMSSW_BASE}/src</div>
<div class="line">git cms-merge-topic -u pastika:AddAxis1_1026</div>
<div class="line">git clone git@github.com:susy2015/<a class="code" href="classTopTagger.html">TopTagger</a>.git</div>
<div class="line">scram b -j4</div>
</div><!-- fragment --><p>The configuration file to generate nanoAOD can then be generated with the following set of instructions on this [[twiki][<a href="https://twiki.cern.ch/twiki/bin/view/CMSPublic/WorkBookNanoAOD#Instructions_for_NanoAODv5_produ">https://twiki.cern.ch/twiki/bin/view/CMSPublic/WorkBookNanoAOD#Instructions_for_NanoAODv5_produ</a>]] via the cmsDriver.py with the addition of the following customize statement as in the example below. The command to check out the required top tagger configuration file is also given below.</p>
<div class="fragment"><div class="line">cd ${CMSSW_BASE}/src</div>
<div class="line">cmsDriver.py myNanoProdMc2017 -s NANO --mc --eventcontent NANOAODSIM --datatier NANOAODSIM  --no_exec  --conditions 102X_mc2017_realistic_v7 --era Run2_2017,run2_nanoAOD_94XMiniAODv2 --customise_commands=<span class="stringliteral">&quot;process.add_(cms.Service(&#39;InitRootHandlers&#39;, EnableIMT = cms.untracked.bool(False)))&quot;</span> --customise <a class="code" href="classTopTagger.html">TopTagger</a>/<a class="code" href="classTopTagger.html">TopTagger</a>/resolvedTagger_cff.customizeResolvedTagger</div>
<div class="line">mkdir -p ${CMSSW_BASE}/src/<a class="code" href="classTopTagger.html">TopTagger</a>/<a class="code" href="classTopTagger.html">TopTagger</a>/data</div>
<div class="line">getTaggerCfg.sh -o -n -t DeepResolved_DeepCSV_GR_noDisc_Release_v1.0.0 -d $CMSSW_BASE/src/<a class="code" href="classTopTagger.html">TopTagger</a>/<a class="code" href="classTopTagger.html">TopTagger</a>/data</div>
</div><!-- fragment --><p>This will produce a file "myNanoProdMc2017_NANO.py" which can be run as follows to produce a small test nanoAOD file with the top tagger variables included</p>
<div class="fragment"><div class="line">cmsRun myNanoProdMc2017_NANO.py</div>
</div><!-- fragment --><h3>Instructions for producing jet variables for resolved top tagger in nanoAOD</h3>
<p>The configuration file to generate nanoAOD with top tagger variables can be generated with the following set of instructions via cmsDriver.py</p>
<div class="fragment"><div class="line">cd ${CMSSW_BASE}/src</div>
<div class="line">cmsDriver.py myNanoProdMc2017 -s NANO --mc --eventcontent NANOAODSIM --datatier NANOAODSIM  --no_exec  --conditions 102X_mc2017_realistic_v7 --era Run2_2017,run2_nanoAOD_94XMiniAODv2 --customise_commands=<span class="stringliteral">&quot;process.add_(cms.Service(&#39;InitRootHandlers&#39;, EnableIMT = cms.untracked.bool(False)))&quot;</span> --customise <a class="code" href="classTopTagger.html">TopTagger</a>/<a class="code" href="classTopTagger.html">TopTagger</a>/resolvedTagger_cff.customizeResolvedTaggerVariables</div>
<div class="line">mkdir -p ${CMSSW_BASE}/src/<a class="code" href="classTopTagger.html">TopTagger</a>/<a class="code" href="classTopTagger.html">TopTagger</a>/data</div>
<div class="line">getTaggerCfg.sh -o -n -t DeepResolved_DeepCSV_GR_noDisc_Release_v1.0.0 -d $CMSSW_BASE/src/<a class="code" href="classTopTagger.html">TopTagger</a>/<a class="code" href="classTopTagger.html">TopTagger</a>/data</div>
</div><!-- fragment --><h3>OLD: Instructions for producing jet variables for resolved top tagger in CMSSW_8_0_28_patch1</h3>
<p>The solution using nanoAOD is the recomended way to get resolved top tagger variables.</p>
<p>Setting up a new CMSSW 8_0_28_patch1 release to produce the resolved top tagger variables.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#get CMSSW release</span></div>
<div class="line"><span class="preprocessor"></span>cmsrel CMSSW_8_0_28_patch1</div>
<div class="line">cd CMSSW_8_0_28_patch1/src/</div>
<div class="line"><span class="preprocessor">#initialize cms and cms git commands </span></div>
<div class="line"><span class="preprocessor"></span>cmsenv</div>
<div class="line">git cms-init</div>
<div class="line"><span class="preprocessor">#patch to qg producer to add axis1</span></div>
<div class="line"><span class="preprocessor"></span>git cms-merge-topic -u pastika:AddJetAxis1</div>
<div class="line"><span class="preprocessor">#compile</span></div>
<div class="line"><span class="preprocessor">scram b -j8</span></div>
</div><!-- fragment --><p>The following code should be added to your CMSSW config file to prepare the jet collection with all necessary variables.</p>
<div class="fragment"><div class="line">jetTag = cms.InputTag(<span class="stringliteral">&quot;slimmedJets&quot;</span>)</div>
<div class="line"></div>
<div class="line">process.load(<span class="stringliteral">&#39;RecoJets.JetProducers.QGTagger_cfi&#39;</span>)</div>
<div class="line">process.QGTagger.srcJets   = cms.InputTag(<span class="stringliteral">&quot;slimmedJets&quot;</span>)</div>
<div class="line"></div>
<div class="line">from PhysicsTools.PatAlgos.tools.jetTools <span class="keyword">import</span> updateJetCollection</div>
<div class="line"></div>
<div class="line">updateJetCollection(</div>
<div class="line">   process,</div>
<div class="line">   labelName = <span class="stringliteral">&quot;DeepCSV&quot;</span>,</div>
<div class="line">   jetSource = cms.InputTag(<span class="stringliteral">&quot;slimmedJets&quot;</span>),</div>
<div class="line">   jetCorrections = (<span class="stringliteral">&#39;AK4PFchs&#39;</span>, cms.vstring([<span class="stringliteral">&#39;L1FastJet&#39;</span>, <span class="stringliteral">&#39;L2Relative&#39;</span>, <span class="stringliteral">&#39;L3Absolute&#39;</span>]), <span class="stringliteral">&#39;None&#39;</span>),</div>
<div class="line">   btagDiscriminators = [</div>
<div class="line">      <span class="stringliteral">&#39;pfDeepCSVJetTags:probudsg&#39;</span>,</div>
<div class="line">      <span class="stringliteral">&#39;pfDeepCSVJetTags:probb&#39;</span>,</div>
<div class="line">      <span class="stringliteral">&#39;pfDeepCSVJetTags:probc&#39;</span>,</div>
<div class="line">      <span class="stringliteral">&#39;pfDeepCSVJetTags:probbb&#39;</span>,</div>
<div class="line">      <span class="stringliteral">&#39;pfDeepCSVJetTags:probcc&#39;</span>,</div>
<div class="line">      ] ## to add discriminators                                                                                                                                                                                                              </div>
<div class="line">)</div>
<div class="line"></div>
<div class="line">process.updatedPatJetsDeepCSV.userData.userFloats.src += [<span class="stringliteral">&#39;QGTagger:qgLikelihood&#39;</span>, <span class="stringliteral">&#39;QGTagger:ptD&#39;</span>, <span class="stringliteral">&#39;QGTagger:axis1&#39;</span>, <span class="stringliteral">&#39;QGTagger:axis2&#39;</span>,]</div>
<div class="line">process.updatedPatJetsDeepCSV.userData.userInts.src += [<span class="stringliteral">&#39;QGTagger:mult&#39;</span>,]</div>
</div><!-- fragment --><p>This will produce a jet collection called 'selectedUpdatedPatJetsDeepCSV' which contains all necessary variables for the resolved top tagger.</p>
<p>The necessary variables can then be accessed in a edm producer as follows</p>
<div class="fragment"><div class="line">{c++}</div>
<div class="line"><span class="comment">//in constructor</span></div>
<div class="line">JetTok_ = consumes&lt;std::vector&lt;pat::Jet&gt; &gt;(edm::InputTag(<span class="stringliteral">&quot;selectedUpdatedPatJetsDeepCSV&quot;</span>));</div>
</div><!-- fragment --><div class="fragment"><div class="line">{c++}</div>
<div class="line"><span class="comment">//in produce(...)</span></div>
<div class="line">edm::Handle&lt;std::vector&lt;pat::Jet&gt; &gt; jets;</div>
<div class="line">iEvent.getByToken(JetTok_, jets);</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">for</span>(<span class="keyword">const</span> pat::Jet&amp; jet : *jets)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">//No need to keep jets below 20 GeV</span></div>
<div class="line">    <span class="keywordflow">if</span>(jet.pt() &lt; 20) <span class="keywordflow">continue</span>;</div>
<div class="line"></div>
<div class="line">    TLorentzVector perJetLVec;</div>
<div class="line">    perJetLVec.SetPtEtaPhiE( jet.pt(), jet.eta(), jet.phi(), jet.energy() );</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">double</span> qgPtD = jet.userFloat(<span class="stringliteral">&quot;QGTagger:ptD&quot;</span>);</div>
<div class="line">    <span class="keywordtype">double</span> qgAxis1 = jet.userFloat(<span class="stringliteral">&quot;QGTagger:axis1&quot;</span>);</div>
<div class="line">    <span class="keywordtype">double</span> qgAxis2 = jet.userFloat(<span class="stringliteral">&quot;QGTagger:axis2&quot;</span>);</div>
<div class="line">    <span class="keywordtype">double</span> qgMult = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(jet.userInt(<span class="stringliteral">&quot;QGTagger:mult&quot;</span>));</div>
<div class="line">    <span class="keywordtype">double</span> deepCSVb = jet.bDiscriminator(<span class="stringliteral">&quot;pfDeepCSVJetTags:probb&quot;</span>);</div>
<div class="line">    <span class="keywordtype">double</span> deepCSVc = jet.bDiscriminator(<span class="stringliteral">&quot;pfDeepCSVJetTags:probc&quot;</span>);</div>
<div class="line">    <span class="keywordtype">double</span> deepCSVl = jet.bDiscriminator(<span class="stringliteral">&quot;pfDeepCSVJetTags:probudsg&quot;</span>);</div>
<div class="line">    <span class="keywordtype">double</span> deepCSVbb = jet.bDiscriminator(<span class="stringliteral">&quot;pfDeepCSVJetTags:probbb&quot;</span>);</div>
<div class="line">    <span class="keywordtype">double</span> deepCSVcc = jet.bDiscriminator(<span class="stringliteral">&quot;pfDeepCSVJetTags:probcc&quot;</span>);</div>
<div class="line">    <span class="keywordtype">double</span> btag = jet.bDiscriminator(<span class="stringliteral">&quot;pfCombinedInclusiveSecondaryVertexV2BJetTags&quot;</span>);</div>
<div class="line">    <span class="keywordtype">double</span> chargedHadronEnergyFraction = jet.chargedHadronEnergyFraction();</div>
<div class="line">    <span class="keywordtype">double</span> neutralHadronEnergyFraction = jet.neutralHadronEnergyFraction();</div>
<div class="line">    <span class="keywordtype">double</span> chargedEmEnergyFraction = jet.chargedEmEnergyFraction();</div>
<div class="line">    <span class="keywordtype">double</span> neutralEmEnergyFraction = jet.neutralEmEnergyFraction();</div>
<div class="line">    <span class="keywordtype">double</span> muonEnergyFraction = jet.muonEnergyFraction();</div>
<div class="line">    <span class="keywordtype">double</span> photonEnergyFraction = jet.photonEnergyFraction();</div>
<div class="line">    <span class="keywordtype">double</span> electronEnergyFraction = jet.electronEnergyFraction();</div>
<div class="line">    <span class="keywordtype">double</span> recoJetsHFHadronEnergyFraction = jet.HFHadronEnergyFraction();</div>
<div class="line">    <span class="keywordtype">double</span> recoJetsHFEMEnergyFraction = jet.HFEMEnergyFraction();</div>
<div class="line">    <span class="keywordtype">double</span> chargedHadronMultiplicity = jet.chargedHadronMultiplicity();</div>
<div class="line">    <span class="keywordtype">double</span> neutralHadronMultiplicity = jet.neutralHadronMultiplicity();</div>
<div class="line">    <span class="keywordtype">double</span> photonMultiplicity = jet.photonMultiplicity();</div>
<div class="line">    <span class="keywordtype">double</span> electronMultiplicity = jet.electronMultiplicity();</div>
<div class="line">    <span class="keywordtype">double</span> muonMultiplicity = jet.muonMultiplicity();</div>
<div class="line">}</div>
</div><!-- fragment --><p>For convinenent use with the top tagger the 4-vector and each jet variable can be saved in a flat tuple in its own std::vector per event.</p>
<h4>OLD: Instructions for running tagger with CMSSW 8_0_28_patch1</h4>
<p>DEPRICATED!!! DO NOT USE THE INSTRUCTIONS IN THIS SECTION!!!</p>
<p>Please use the instruction above for producing the tagger in nanoAOD.</p>
<p>In addition to the top tagger itself these instructions include the steps to configure additional packages, including the deepFlavor tagger (for the tagger itself along with the tensorflow configuration for 8X), a patch to the qg producer to produce the Axis1 variable, and a version of the jet toolbox with a minor bug fix,</p>
<div class="fragment"><div class="line"><span class="preprocessor">#get CMSSW release</span></div>
<div class="line"><span class="preprocessor"></span>cmsrel CMSSW_8_0_28_patch1</div>
<div class="line">cd CMSSW_8_0_28_patch1/src/</div>
<div class="line">cmsenv</div>
<div class="line">git cms-init</div>
<div class="line"><span class="preprocessor">#configure deep Flavor https://twiki.cern.ch/twiki/bin/viewauth/CMS/DeepJet</span></div>
<div class="line"><span class="preprocessor"></span>git cms-merge-topic -u mverzett:Experimental_DeepFlavour_80X</div>
<div class="line">cd RecoBTag/DeepFlavour/scripts/</div>
<div class="line">wget -nv http:<span class="comment">//www-ekp.physik.uni-karlsruhe.de/~harrendorf/tensorflow-cmssw8-0-26.tar.gz</span></div>
<div class="line">tar -zxf tensorflow-cmssw8-0-26.tar.gz</div>
<div class="line">mv tensorflow-cmssw8-0-26-patch1/site-packages ../../Tensorflow/python</div>
<div class="line">rm -rf tensorflow-cmssw8-0-26.tar.gz tensorflow-cmssw8-0-26-patch1/</div>
<div class="line">cd <span class="stringliteral">&quot;$CMSSW_BASE/src&quot;</span></div>
<div class="line">scram setup <span class="stringliteral">&quot;RecoBTag/Tensorflow/py2-numpy-c-api.xml&quot;</span></div>
<div class="line">cmsenv</div>
<div class="line"><span class="preprocessor">#patch to gq producer to add axis1</span></div>
<div class="line"><span class="preprocessor"></span>git cms-merge-topic -u pastika:AddJetAxis1</div>
<div class="line"><span class="preprocessor">#patched version of jet toolbox</span></div>
<div class="line"><span class="preprocessor"></span>git clone git@github.com:susy2015/JetToolbox.git JMEAnalysis/JetToolbox -b fix_NoLep_jetToolbox_80X_V3</div>
<div class="line"><span class="preprocessor">#download top tagger code </span></div>
<div class="line"><span class="preprocessor"></span>git clone -b IntermediateRecipeV0 git@github.com:susy2015/<a class="code" href="classTopTagger.html">TopTagger</a>.git</div>
<div class="line"><span class="preprocessor">#compile everything </span></div>
<div class="line"><span class="preprocessor"></span>scram b -j12</div>
<div class="line">cd <a class="code" href="classTopTagger.html">TopTagger</a>/<a class="code" href="classTopTagger.html">TopTagger</a>/test</div>
<div class="line"><span class="preprocessor">#get qgl database file</span></div>
<div class="line"><span class="preprocessor"></span>wget https:<span class="comment">//raw.githubusercontent.com/cms-jet/QGLDatabase/master/SQLiteFiles/QGL_cmssw8020_v2.db</span></div>
<div class="line"><span class="preprocessor">#get top tager cfg file and MVA model files </span></div>
<div class="line"><span class="preprocessor"></span>../../Tools/getTaggerCfg.sh -t Intermediate_Example_v1.0.0</div>
<div class="line"><span class="preprocessor">#run example code</span></div>
<div class="line"><span class="preprocessor"></span>voms-proxy-init</div>
<div class="line">cmsRun run_topTagger.py</div>
</div><!-- fragment --><p>The default configuration of the example cfg file "run_topTagger.py" will run over a single-lepton ttbar sample and produce an edm formatted output file ("test.root") containing the vector of reconstructed top TLorentzVectors along with a second vector indicating the type of top (monojet, dijet, trijet).</p>
<h2>More about getting a configuration file</h2>
<p>Before the top tagger can be used the top tagger configuration file must be checked out. Configuration files for top tagger working points are stored in the Susy2015/TopTaggerCfg repository and are published through releases. These should not be accessed directly, but instead you can use the script "getTaggerCfg.sh" to download the working points desired. An example of a basic checkout of the standard working point for use with the example code (different working points are found here <a href="https://github.com/susy2015/TopTaggerCfg/releases">https://github.com/susy2015/TopTaggerCfg/releases</a>) is as follows</p>
<div class="fragment"><div class="line"><span class="preprocessor">#run the following once to set up the top tagger and add the &quot;getTaggerCfg.sh&quot; to the path</span></div>
<div class="line"><span class="preprocessor"></span>source <a class="code" href="classTopTagger.html">TopTagger</a>/<a class="code" href="classTopTagger.html">TopTagger</a>/test/taggerSetup.sh</div>
<div class="line">getTaggerCfg.sh -t MVAAK8_Tight_noQGL_binaryCSV_v1.0.2</div>
</div><!-- fragment --><p>This will download the configuration file along with the MVA training file if appropriate into a directory. It will then softlink the files into your current directory so this script is intended to be run from the same directory as you will run your code. If you want the directory containing the configuration file and MVA file to be located elsewhere this can be specified with the "-d" option (Multiple run directories can point to the same directory, this can be helpful to save space as the random forest training files are quite large). If you have multiple configuration files you can specify a different name for the configuration file with the "-f" option. Finally, if you want to download the file without creating the softlinks use the "-n" option.</p>
<h2>Top tagger structure</h2>
<p>The top tagger code is written to take modules which act on a central object to produce the final collection of top objects. The tagger framework consists of the following classes (found in TopTagger/TopTagger/)</p>
<h3>Top Tagger Modules and the Configuration File.</h3>
<p>The configuration file is central to the functioning of the top tagger code. This file is a basic text file implemented to follow the structure of the HCAL configuration parser and the code can be found here "TopTagger/CfgParser." This code upon which this is based can be found here (<a href="https://svnweb.cern.ch/cern/wsvn/cmshcos/trunk/hcalBase/include/hcal/cfg/?#aafaf15fcace155f9a3d702b52eb6d719">https://svnweb.cern.ch/cern/wsvn/cmshcos/trunk/hcalBase/include/hcal/cfg/?#aafaf15fcace155f9a3d702b52eb6d719</a>). The configuration script is used to tell the top tagger what modules to run and in which order, in addition to allowing any parameters necessary for the tagger and each module to be defined cleanly in one place. An example configuration script can be found in TopTagger/TopTagger/test/Example_TopTagger.cfg</p>
<p>Modules are where all the real work of the top tagger is done. Each module performs a particular task and stores its results in a <a class="el" href="classTopTaggerResults.html">TopTaggerResults</a> object which will eventually be presented to the user as a summary of final results. All modules inherit from <a class="el" href="classTTModule.html">TTModule</a> and, as described in <a class="el" href="classTTModule.html">TTModule</a>" implement the 2 functions "getParameter"s and "run." Each module is called automatically from the <a class="el" href="classTopTagger.html">TopTagger</a> class. They are also instantiated automatically based upon the configuration file.</p>
<p>For further documentation of the code and each module see the following webpage <a href="http://susy2015.github.io/TopTagger/html/index.html">http://susy2015.github.io/TopTagger/html/index.html</a>.</p>
<h3><a class="el" href="classTopTagger.html">TopTagger</a></h3>
<p>The <a class="el" href="classTopTagger.html">TopTagger</a> module is the primary (and only mandatory) section in every top tagger configuration. This section defines all the other top tagger modules which will be run and in which order. This module has 2 variables (both arrays) Which are used to define the module run order and if necessary the module context name.</p>
<h4>module[] (string):</h4>
<p>This variable is an array and is used to define which other modules will be run and in which order. This can be any module listed here in this section.</p>
<h4>context[] (string):</h4>
<p>This variable must be specified for any module being run more than once to specify what context name to read its configuration from. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jul 18 2019 15:41:58 for TopTagger by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
